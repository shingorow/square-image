var b=Object.defineProperty;var C=(a,t,i)=>t in a?b(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i;var u=(a,t,i)=>(C(a,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function i(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(e){if(e.ep)return;e.ep=!0;const n=i(e);fetch(e.href,n)}})();class O{constructor(){u(this,"configKey","marginSettings");u(this,"storage",window.localStorage)}get(){const t=[{label:"None",value:0,active:!0},{label:"2%",value:.02,active:!1},{label:"5%",value:.05,active:!1},{label:"10%",value:.1,active:!1}],i=JSON.parse(this.storage.getItem(this.configKey));return typeof i!="object"||i===null?(this.storage.setItem(this.configKey,JSON.stringify(t)),t):i}set(t){if(t===null)return;const i=JSON.parse(this.storage.getItem(this.configKey));for(const s in i)i[s].active=i[s].value===parseFloat(t);return this.storage.setItem(this.configKey,JSON.stringify(i)),i}}class E{create(t,i,s=()=>{}){const e=document.querySelector(i);for(;e.lastChild;)e.removeChild(e.lastChild);const n=[];for(const o of t){const r=document.createElement("li"),l=document.createElement("button");l.dataset.margin=o.value,l.textContent=o.label,o.active&&l.classList.add("active"),r.appendChild(l),e.appendChild(r),n.push(r)}return n}}class I{draw(t,i,s){const e=document.querySelector(t),n=e.getContext("2d"),o=1-i;n.clearRect(0,0,e.width,e.height),n.beginPath(),n.fillStyle="white",n.fillRect(0,0,e.width,e.height);const r=new FileReader;r.onload=function(l){const c=new Image;c.onload=function(){const w=Math.max(c.width,c.height),m=Math.max(e.width,e.height)/w,v=c.width*m*o,y=c.height*m*o,S=(e.width-v)/2,L=(e.height-y)/2;n.drawImage(c,S,L,v,y)},c.src=r.result},r.readAsDataURL(s)}download(t){document.querySelector(t).toBlob(s=>{const e=new File([s],"square-image.png",{type:"image/png"});navigator.share({title:"Square Image",text:"https://sim.engrowth.work/",files:[e]}).catch(n=>{alert("Some errors!")})},"image/png")}}const g=new O;let f=g.get();const p="#file",h="#canvas",q=new E,d=new I;document.addEventListener("DOMContentLoaded",()=>{const a=document.querySelector(p),t=q.create(f,"#margin-size-list",g.set.bind(g),d.draw,p,h);for(const s of t)s.firstChild.addEventListener("click",e=>{for(const r of t)r.firstChild.classList.remove("active");e.target.classList.add("active");const n=e.target.dataset.margin,o=a.files[0]??null;o&&d.draw(h,n,o),f=g.set(n)});a.addEventListener("change",s=>{const n=f.find(o=>o.active).value;d.draw(h,n,s.target.files[0])}),document.querySelector("#download").addEventListener("click",()=>{d.download("#canvas")})});
